# Synthetic Image Generation Pipeline

This repository generates synthetic error-bar chart images and matching label JSON files.

## Requirements

- Python 3
- Packages in `requirements.txt`

Install dependencies:

```bash
pip install -r requirements.txt
```

## Run

By default, outputs go to the `synthetic_data/` subfolder:

- images: `synthetic_data/images/`
- labels: `synthetic_data/labels/`

Generate 3000 images with learned stats and a manifest:

```bash
python3 synth_pipeline.py \
  --count 3000 \
  --learn-from-labels \
  --use-existing-sizes
```

Notes:

- If `--stats` exists, it is loaded and learning is skipped. Delete it to recompute.
- Learning excludes files with the `synth_` prefix by default. Override with `--exclude-prefix ""` to include all files.
- If you want different output locations, pass `--images` and `--labels`.

Example custom output paths:

```bash
python3 synth_pipeline.py \
  --count 500 \
  --images ./out/images \
  --labels ./out/labels \
  --stats ./out/learned_stats.json \
  --manifest ./out/manifest.jsonl
```

## Visual stats (style priors)

If you have a visual stats JSON (generated by `analyze_images.py`), you can bias styles such as grids, markers, caps, series counts, and background colors:

```bash
python3 synth_pipeline.py \
  --count 1000 \
  --visual-stats ./visual_stats.json
```

## Engine options

Rendering engines:

- `--engine auto` (default): chooses among available engines.
- `--engine mpl|seaborn|pandas|plotly|bokeh`: force a specific backend.

You can also adjust the auto-selection weights:

```bash
python3 synth_pipeline.py \
  --count 500 \
  --engine auto \
  --engine-weights mpl:0.5,seaborn:0.2,pandas:0.1,plotly:0.1,bokeh:0.1
```

Notes:

- Engines are only available if the corresponding Python packages are installed.
- If a forced engine fails at runtime, the script falls back to Matplotlib.
- Auto mode skips Plotly/Bokeh unless you explicitly include them via `--engine` or `--engine-weights`.
